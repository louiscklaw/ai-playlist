services:
  poe-scheduler-api:
    # build: ./poe-scheduler-api
    image: logickee/poe-tryout-poe-scheduler-api
    ports:
      - 3002:3002
    volumes:
      - /usr/share/zoneinfo/Asia/Hong_Kong:/etc/localtime:ro
      - ./poe-scheduler-api/:/app
      - ./volumes/static-share:/share
      - ./volumes/logs:/logs
    env_file: ./.env

    working_dir: /app
    restart: unless-stopped
    entrypoint: ./entry.sh
    environment:
      - TZ=Asia/Hong_Kong
      - LOG_PREFIX=poe-scheduler-api

    depends_on:
      redis:
        condition: service_healthy      
    healthcheck:
      test: ['CMD', 'curl', '-f', 'http://localhost:3002/healthcheck']
      interval: 10s
      timeout: 10s
      retries: 5
